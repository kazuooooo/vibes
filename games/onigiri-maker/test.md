# おにぎりメーカー – Playwright E2E テストケース

## 概要

本ドキュメントは、Webカジュアルゲーム「おにぎりメーカー」のE2Eテストケース一覧です。Playwrightを用いて、UI選択機能、組み合わせロジック、評価システム、プレビュー機能などの一貫性と正確性を検証します。

---

## 📘 前提条件

- アプリは `/` ルートで起動
- ページ読み込み時にゲームが初期状態で表示される
- 以下のセレクターが利用可能であること（data-testid）

| テストID | 対象UI |
|----------|--------|
| `title` | ゲームタイトル表示 |
| `ingredient-ume` | 梅干し選択ボタン |
| `ingredient-salmon` | 鮭選択ボタン |
| `ingredient-konbu` | 昆布選択ボタン |
| `ingredient-tuna-mayo` | ツナマヨ選択ボタン |
| `ingredient-mentaiko` | 明太子選択ボタン |
| `shape-triangle` | 三角形選択ボタン |
| `shape-barrel` | 俵型選択ボタン |
| `shape-round` | 丸型選択ボタン |
| `shape-square` | 四角選択ボタン |
| `nori-full` | 全巻き選択ボタン |
| `nori-half` | 半巻き選択ボタン |
| `nori-hand-roll` | 手巻き風選択ボタン |
| `nori-none` | のりなし選択ボタン |
| `preview-area` | プレビューエリア |
| `make-button` | 作るボタン |
| `reset-button` | リセットボタン |
| `result-area` | 結果表示エリア |
| `score-display` | 点数表示 |
| `rank-display` | ランク表示 |
| `comment-display` | コメント表示 |
| `retry-button` | もう一度作るボタン |
| `creation-count` | 作成回数カウンター |

---

## 🧪 テストケース一覧

### TC01: 初期画面の表示確認

**目的**: ページ初期ロード時にすべてのUI要素が適切に表示されるか確認

**手順**
1. `/` にアクセス
2. `title` が「おにぎりメーカー」と表示されることを確認
3. 具材選択ボタンが5つ（梅干し、鮭、昆布、ツナマヨ、明太子）表示されることを確認
4. 形選択ボタンが4つ（三角、俵型、丸型、四角）表示されることを確認
5. のり選択ボタンが4つ（全巻き、半巻き、手巻き風、のりなし）表示されることを確認
6. `make-button` が無効状態で表示されることを確認
7. `reset-button` が表示されることを確認
8. `creation-count` が「0」と表示されることを確認

---

### TC02: 具材選択機能

**目的**: 具材選択ボタンが正常に動作することを確認

**手順**
1. `/` にアクセス
2. `ingredient-ume` をクリック
3. ボタンが選択状態（視覚的にハイライト）になることを確認
4. `preview-area` に梅干しが反映されることを確認
5. 他の具材ボタン（`ingredient-salmon`）をクリック
6. 前の選択（梅干し）が解除され、新しい選択（鮭）がハイライトされることを確認
7. プレビューも鮭に更新されることを確認

---

### TC03: 形選択機能

**目的**: 形選択ボタンが正常に動作することを確認

**手順**
1. `/` にアクセス
2. `shape-triangle` をクリック
3. ボタンが選択状態になることを確認
4. `preview-area` に三角形が反映されることを確認
5. `shape-round` をクリック
6. 前の選択が解除され、丸型が選択されることを確認
7. プレビューも丸型に更新されることを確認

---

### TC04: のり選択機能

**目的**: のり選択ボタンが正常に動作することを確認

**手順**
1. `/` にアクセス
2. `nori-full` をクリック
3. ボタンが選択状態になることを確認
4. `preview-area` に全巻きが反映されることを確認
5. `nori-none` をクリック
6. 前の選択が解除され、のりなしが選択されることを確認
7. プレビューものりなしに更新されることを確認

---

### TC05: 作るボタンの有効化条件

**目的**: 3つすべて選択した場合のみ作るボタンが有効になることを確認

**手順**
1. `/` にアクセス
2. `make-button` が無効状態であることを確認
3. `ingredient-ume` を選択
4. `make-button` がまだ無効状態であることを確認
5. `shape-triangle` を選択
6. `make-button` がまだ無効状態であることを確認
7. `nori-full` を選択
8. `make-button` が有効状態になることを確認

---

### TC06: おにぎり作成と結果表示

**目的**: おにぎりの作成処理と結果表示が正常に動作することを確認

**手順**
1. `/` にアクセス
2. 梅干し、三角、全巻きを選択
3. `make-button` をクリック
4. `result-area` が表示されることを確認
5. `score-display` に点数が表示されることを確認
6. `rank-display` にランク（S、A、B、C、D）が表示されることを確認
7. `comment-display` にコメントが表示されることを確認
8. `retry-button` が表示されることを確認
9. `creation-count` が「1」に増加することを確認

---

### TC07: 王道コンボの特別評価

**目的**: 特別な組み合わせ（梅干し+三角+全巻き）で高得点が出ることを確認

**手順**
1. `/` にアクセス
2. `ingredient-ume`、`shape-triangle`、`nori-full` を選択
3. `make-button` をクリック
4. `score-display` が90点以上であることを確認
5. `rank-display` が「S」または「A」であることを確認
6. `comment-display` に特別なコメントが表示されることを確認

---

### TC08: リセット機能

**目的**: リセットボタンでselection状態がクリアされることを確認

**手順**
1. `/` にアクセス
2. `ingredient-salmon`、`shape-round`、`nori-half` を選択
3. 3つの選択がハイライトされていることを確認
4. `reset-button` をクリック
5. すべての選択がクリアされることを確認
6. `preview-area` が初期状態に戻ることを確認
7. `make-button` が無効状態に戻ることを確認

---

### TC09: もう一度作る機能

**目的**: 結果表示後に「もう一度作る」で初期状態に戻ることを確認

**手順**
1. `/` にアクセス
2. 任意の組み合わせでおにぎりを作成
3. 結果が表示された状態で `retry-button` をクリック
4. `result-area` が非表示になることを確認
5. すべての選択がクリアされることを確認
6. `make-button` が無効状態に戻ることを確認
7. `creation-count` は保持されることを確認

---

### TC10: 複数回作成時のカウンター

**目的**: 作成回数カウンターが正しく増加することを確認

**手順**
1. `/` にアクセス
2. `creation-count` が「0」であることを確認
3. 1回目のおにぎりを作成
4. `creation-count` が「1」になることを確認
5. 「もう一度作る」で2回目を作成
6. `creation-count` が「2」になることを確認
7. 3回目も同様にカウントされることを確認

---

### TC11: 評価システムの動作確認

**目的**: 異なる組み合わせで異なる評価が出ることを確認

**手順**
1. `/` にアクセス
2. 王道組み合わせ（梅干し+三角+全巻き）で作成し、高得点を記録
3. 「もう一度作る」をクリック
4. 変わった組み合わせ（明太子+四角+のりなし）で作成
5. 1回目と異なる点数・ランクが表示されることを確認
6. コメントも組み合わせに応じて変化することを確認

---

### TC12: プレビュー機能の動作確認

**目的**: 選択に応じてプレビューがリアルタイムで更新されることを確認

**手順**
1. `/` にアクセス
2. `ingredient-ume` を選択し、プレビューに反映されることを確認
3. `shape-triangle` を選択し、プレビューが更新されることを確認
4. `nori-full` を選択し、最終的なプレビューが表示されることを確認
5. 選択を変更し、プレビューが即座に更新されることを確認

---

### TC13: モバイル対応確認

**目的**: モバイル画面サイズでレイアウトが正常に表示されることを確認

**手順**
1. ビューポートを iPhone SE サイズ (375x667) に設定
2. `/` にアクセス
3. すべての選択ボタンが適切なサイズで表示されることを確認
4. プレビューエリアが画面内に収まることを確認
5. 結果表示エリアが適切にレイアウトされることを確認
6. ボタンがタッチしやすいサイズであることを確認

---

### TC14: 大画面対応確認

**目的**: デスクトップ大画面でレイアウトが適切に表示されることを確認

**手順**
1. ビューポートを 1920x1080 に設定
2. `/` にアクセス
3. 3つのカテゴリーが横並びで適切に配置されることを確認
4. プレビューエリアが中央に配置されることを確認
5. 全体のレイアウトが美しく表示されることを確認

---

### TC15: 選択状態の視覚的フィードバック

**目的**: 選択されたボタンの視覚的フィードバックが適切であることを確認

**手順**
1. `/` にアクセス
2. 各カテゴリーのボタンをクリック
3. 選択されたボタンが視覚的にハイライトされることを確認
4. 他の同カテゴリーボタンの選択が解除されることを確認
5. ホバー効果が適切に動作することを確認

---

## 🔧 テストのための補足実装（推奨）

- 選択状態をdata属性で確認可能にすること
- プレビューの内容をdata属性またはクラス名で確認可能にすること  
- 評価計算のロジックを検証可能にすること
- テスト用フラグでアニメーションを無効化できること

---

## 📄 備考

- テストはPlaywrightの適切な待機メソッドを使用すること
- アニメーション完了後の状態を検証すること
- 各テストケースは独立して実行可能であること
- 視覚的な確認が重要な部分はスクリーンショット比較を活用すること