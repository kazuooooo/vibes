# リズム忍者 – テストケース

## E2Eテストケース仕様

### 1. ゲーム初期化テスト

#### テストケース 1.1: ページロード
- **目的**: ゲームが正常にロードされることを確認
- **手順**: 
  1. ブラウザでゲームページを開く
  2. ページの読み込み完了を待つ
- **期待結果**: 
  - タイトル「リズム忍者」が表示される
  - スタートボタンが表示される
  - 忍者キャラクターが表示される

#### テストケース 1.2: 初期状態確認
- **目的**: ゲーム開始前の初期状態が正しいことを確認
- **手順**: ページロード後の状態を確認
- **期待結果**:
  - スコア: 0
  - HP: 3（❤️❤️❤️）
  - BPM: 80
  - ゲーム状態: 待機中

---

### 2. ゲーム開始テスト

#### テストケース 2.1: ゲーム開始
- **目的**: スタートボタンでゲームが開始されることを確認
- **手順**:
  1. スタートボタンをクリック
  2. カウントダウン（3-2-1）を待つ
- **期待結果**:
  - カウントダウンが表示される
  - カウントダウン後にゲームが開始される
  - 音楽（メトロノーム）が再生される
  - ビートインジケーターが動作する

---

### 3. 操作・アクションテスト

#### テストケース 3.1: 斬撃アクション（キーボード）
- **目的**: スペースキーによる斬撃が正常に動作することを確認
- **手順**:
  1. ゲームを開始
  2. 地上敵が出現するのを待つ
  3. ビートのタイミングでスペースキーを押す
- **期待結果**:
  - 忍者が斬撃モーションを行う
  - 敵が倒される
  - スコアが増加する
  - 斬撃音が再生される

#### テストケース 3.2: ジャンプアクション（キーボード）
- **目的**: 上矢印キーによるジャンプが正常に動作することを確認
- **手順**:
  1. ゲームを開始
  2. 空中敵が出現するのを待つ
  3. ビートのタイミングで上矢印キーを押す
- **期待結果**:
  - 忍者がジャンプモーションを行う
  - 敵を回避または攻撃する
  - スコアが増加する
  - ジャンプ音が再生される

#### テストケース 3.3: ボタン操作（モバイル/タッチ）
- **目的**: 画面上のボタンによる操作が正常に動作することを確認
- **手順**:
  1. ゲームを開始
  2. 斬撃ボタンをタップ
  3. ジャンプボタンをタップ
- **期待結果**:
  - キーボード操作と同様の動作をする
  - タッチイベントが正確に認識される

---

### 4. タイミング判定テスト

#### テストケース 4.1: Perfect判定
- **目的**: ビート±100ms以内での入力が正確に判定されることを確認
- **手順**:
  1. ゲームを開始
  2. メトロノームの音に合わせて正確なタイミングで入力
- **期待結果**:
  - "Perfect"の判定が表示される
  - スコア×2が獲得される
  - コンボカウンターが増加する

#### テストケース 4.2: Good判定
- **目的**: ビート±200ms以内での入力が正確に判定されることを確認
- **手順**:
  1. ゲームを開始
  2. メトロノームから少しずれたタイミングで入力
- **期待結果**:
  - "Good"の判定が表示される
  - 通常スコアが獲得される
  - コンボが継続する

#### テストケース 4.3: Miss判定
- **目的**: タイミング外での入力がMissとして判定されることを確認
- **手順**:
  1. ゲームを開始
  2. 明らかにタイミングがずれた時に入力
- **期待結果**:
  - "Miss"の判定が表示される
  - HPが1減少する
  - コンボがリセットされる
  - ダメージ音が再生される

---

### 5. ゲームメカニクステスト

#### テストケース 5.1: HP減少とゲームオーバー
- **目的**: HPが0になった時にゲームオーバーになることを確認
- **手順**:
  1. ゲームを開始
  2. 意図的に3回Missする
- **期待結果**:
  - 各Missでハートが1つずつ減る
  3. つめのMiss後にゲームオーバー画面が表示される
  - 最終スコアが表示される
  - リトライボタンが表示される

#### テストケース 5.2: スコア計算
- **目的**: スコアが正確に計算されることを確認
- **手順**:
  1. ゲームを開始
  2. Perfect、Good、Missを組み合わせて入力
- **期待結果**:
  - Perfect: 100点（コンボ倍率適用）
  - Good: 50点
  - Miss: 0点
  - 表示スコアが計算と一致する

#### テストケース 5.3: コンボシステム
- **目的**: コンボシステムが正常に動作することを確認
- **手順**:
  1. ゲームを開始
  2. 連続でPerfectまたはGoodを取る
  3. その後Missする
- **期待結果**:
  - 連続成功でコンボ数が増加
  - コンボ倍率がスコアに適用される
  - Miss時にコンボがリセットされる

---

### 6. 難易度変化テスト

#### テストケース 6.1: BPM上昇
- **目的**: 時間経過によってBPMが上昇することを確認
- **手順**:
  1. ゲームを開始
  2. 30秒間プレイを継続
- **期待結果**:
  - 開始時BPM: 80
  - 30秒後BPM: 90
  - ビートの間隔が短くなる
  - BPM表示が更新される

#### テストケース 6.2: 高速時の操作精度
- **目的**: 高BPM時でもタイミング判定が正確に動作することを確認
- **手順**:
  1. ゲームを長時間プレイしてBPMを上昇させる
  2. 高速ビートに合わせて操作
- **期待結果**:
  - タイミング判定が高BPMでも正確に動作
  - Perfect/Good/Missが適切に判定される

---

### 7. UI・UXテスト

#### テストケース 7.1: レスポンシブデザイン
- **目的**: 異なる画面サイズで正常に表示されることを確認
- **手順**:
  1. デスクトップブラウザでテスト
  2. モバイルブラウザでテスト
  3. タブレットサイズでテスト
- **期待結果**:
  - 全ての画面サイズで要素が適切に配置される
  - タッチ操作が正常に動作する
  - 文字が読みやすい

#### テストケース 7.2: ビジュアルフィードバック
- **目的**: 視覚的なフィードバックが適切に表示されることを確認
- **手順**:
  1. 様々なアクションを実行
  2. 判定結果を確認
- **期待結果**:
  - アクションエフェクトが表示される
  - 判定結果がはっきり見える
  - ビートインジケーターが分かりやすい

---

### 8. 音響テスト

#### テストケース 8.1: 音声再生
- **目的**: 音声が正常に再生されることを確認
- **手順**:
  1. ゲームを開始
  2. 各種アクションを実行
- **期待結果**:
  - メトロノーム音が一定間隔で再生
  - 効果音（斬撃、ジャンプ、ダメージ）が適切なタイミングで再生
  - 音声とビジュアルが同期している

---

### 9. エラーハンドリングテスト

#### テストケース 9.1: 音声エラー処理
- **目的**: 音声が利用できない環境での動作を確認
- **手順**:
  1. 音声無効の環境でゲームを開始
- **期待結果**:
  - ゲームが正常に開始される
  - ビジュアルインジケーターでリズムが把握可能
  - エラーメッセージが適切に表示される

#### テストケース 9.2: パフォーマンステスト
- **目的**: 長時間プレイでのパフォーマンスを確認
- **手順**:
  1. 5分間連続でプレイ
  2. メモリ使用量とフレームレートを監視
- **期待結果**:
  - メモリリークが発生しない
  - フレームレートが維持される
  - 動作が重くならない