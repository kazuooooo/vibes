# 変顔メーカー – Playwright E2E テストケース

## 概要

本ドキュメントは、Webカジュアルゲーム「変顔メーカー」のE2Eテストケース一覧です。Playwrightを用いて、UIの描画、ドラッグ操作、パーツの位置管理などの一貫性と正確性を検証します。

---

## 📘 前提条件

- アプリは `/` ルートで起動
- ページ読み込み時にゲームが初期状態で表示される
- 各顔パーツが初期位置に配置されている
- 以下のセレクターが利用可能であること（data-testid）

| テストID | 対象UI |
|----------|--------|
| `title` | ゲームタイトル表示 |
| `face-base` | 顔のベース（輪郭） |
| `left-eye` | 左目パーツ |
| `right-eye` | 右目パーツ |
| `nose` | 鼻パーツ |
| `mouth` | 口パーツ |
| `left-eyebrow` | 左眉毛パーツ |
| `right-eyebrow` | 右眉毛パーツ |
| `complete-button` | 完成ボタン |
| `reset-button` | リセットボタン |
| `new-face-button` | 新しく作るボタン |

---

## 🧪 テストケース一覧

### TC01: 初期表示の確認

**目的**: ページ初期ロード時にUI要素が表示されるか確認

**手順**
1. `/` にアクセス
2. `title`, `face-base`, `left-eye`, `right-eye`, `nose`, `mouth` が存在することを確認
3. `complete-button`, `reset-button` が有効であることを確認
4. 各パーツが初期位置に配置されていることを確認

---

### TC02: 左目のドラッグ操作

**目的**: 左目パーツが正しくドラッグできることを確認

**手順**
1. `/` にアクセス
2. `left-eye` の初期位置を取得
3. `left-eye` を50px右、30px下にドラッグ
4. `left-eye` の位置が変更されていることを確認
5. 他のパーツの位置が変更されていないことを確認

---

### TC03: 右目のドラッグ操作

**目的**: 右目パーツが正しくドラッグできることを確認

**手順**
1. `/` にアクセス
2. `right-eye` の初期位置を取得
3. `right-eye` を30px左、20px上にドラッグ
4. `right-eye` の位置が変更されていることを確認

---

### TC04: 鼻のドラッグ操作

**目的**: 鼻パーツが正しくドラッグできることを確認

**手順**
1. `/` にアクセス
2. `nose` の初期位置を取得
3. `nose` を20px左、40px下にドラッグ
4. `nose` の位置が変更されていることを確認

---

### TC05: 口のドラッグ操作

**目的**: 口パーツが正しくドラッグできることを確認

**手順**
1. `/` にアクセス
2. `mouth` の初期位置を取得
3. `mouth` を60px右、10px上にドラッグ
4. `mouth` の位置が変更されていることを確認

---

### TC06: 複数パーツの同時移動

**目的**: 複数のパーツを連続してドラッグできることを確認

**手順**
1. `/` にアクセス
2. `left-eye` をドラッグして移動
3. `right-eye` をドラッグして移動
4. `mouth` をドラッグして移動
5. 各パーツが意図した位置に配置されていることを確認

---

### TC07: 完成ボタンの動作

**目的**: 完成ボタンが正しく動作することを確認

**手順**
1. `/` にアクセス
2. いくつかのパーツをドラッグして移動
3. `complete-button` をクリック
4. 完成画面が表示されることを確認
5. `new-face-button` が表示されることを確認

---

### TC08: リセットボタンの動作

**目的**: リセットボタンで初期状態に戻ることを確認

**手順**
1. `/` にアクセス
2. 全てのパーツをドラッグして初期位置から移動
3. `reset-button` をクリック
4. 全てのパーツが初期位置に戻ることを確認

---

### TC09: 新しく作るボタンの動作

**目的**: 完成画面から新しいゲームを開始できることを確認

**手順**
1. ゲームを完成まで進める
2. `new-face-button` をクリック
3. ゲーム画面に戻ることを確認
4. 全てのパーツが初期位置に配置されていることを確認

---

### TC10: 境界値テスト（顔の範囲外への移動）

**目的**: パーツが顔の範囲外に移動しないことを確認

**手順**
1. `/` にアクセス
2. `left-eye` を顔の範囲を大きく超える位置にドラッグを試行
3. パーツが顔の範囲内に留まることを確認
4. 他のパーツでも同様にテスト

---

### TC11: モバイル対応確認（タッチ操作）

**目的**: モバイル環境でタッチ操作が正しく動作することを確認

**手順**
1. ビューポートを iPhone SE サイズ (375x667) に設定
2. `/` にアクセス
3. タッチ操作で `left-eye` をドラッグ
4. パーツが正しく移動することを確認
5. 主要UI がモバイル画面に適切に表示されることを確認

---

### TC12: 連続操作の安定性

**目的**: 連続したドラッグ操作で状態が不正にならないことを確認

**手順**
1. `/` にアクセス
2. 同じパーツを10回連続でドラッグ
3. パーツが正しく追従することを確認
4. ゲームの状態が安定していることを確認

---

## 🔧 テストのための補足実装（推奨）

- 各パーツの座標情報をdata属性またはスタイル属性で取得可能にすること
- テスト中のみドラッグ範囲制限を緩和するオプション（例: ?test=true）を用意すると検証しやすい
- パーツの移動アニメーションがある場合は、テスト時は即座に移動するオプションを検討

---

## 📄 備考

- ドラッグ操作のテストは `page.mouse.move()` と `page.mouse.down()`, `page.mouse.up()` を組み合わせて実装
- タッチ操作のテストは `page.touchscreen.tap()` を使用
- パーツの位置確認は `getBoundingClientRect()` や CSS プロパティで座標を取得
- アニメーションがある場合は適切な待機時間を考慮すること