# スローライフ剣士 – Playwright E2E テストケース

## 概要

本ドキュメントは、Webカジュアルゲーム「スローライフ剣士」のE2Eテストケース一覧です。Playwrightを用いて、UIの描画、ユーザーインタラクション、ゲームロジックなどの一貫性と正確性を検証します。

---

## 📘 前提条件

- アプリは `/` ルートで起動
- ページ読み込み時にゲームが初期状態で表示される
- 以下のセレクターが利用可能であること（data-testid）

| テストID | 対象UI |
|----------|--------|
| `game-title` | ゲームタイトル表示 |
| `score` | スコア表示エリア |
| `health` | 体力表示エリア |
| `timer` | 残り時間表示 |
| `slash-button` | 「斬る」ボタン |
| `swordsman` | 剣士キャラクター |
| `game-field` | ゲームフィールド |
| `restart-button` | ゲーム再開ボタン |
| `enemy` | 敵キャラクター（動的） |
| `attack-range` | 攻撃範囲表示 |

---

## 🧪 テストケース一覧

### TC01: 初期表示の確認

**目的**: ページ初期ロード時にUI要素が表示されるか確認

**手順**
1. `/` にアクセス
2. `game-title`, `score`, `health`, `timer`, `slash-button` が存在することを確認
3. `swordsman` が画面中央付近に表示されることを確認
4. 初期スコアが「0」、体力が「3」、タイマーが「60」であることを確認

---

### TC02: ゲームの開始確認

**目的**: ゲーム開始時にタイマーがカウントダウンすることを確認

**手順**
1. `/` にアクセス
2. `timer` の値を取得して一時保存
3. 1秒待機
4. 再度 `timer` を取得し、値が減少していることを検証

---

### TC03: 敵の出現確認

**目的**: 敵が定期的に出現することを確認

**手順**
1. `/` にアクセス
2. 5秒間待機
3. `enemy` 要素が少なくとも1つ存在することを確認
4. 敵が画面の左端または右端から出現していることを確認

---

### TC04: 敵の移動確認

**目的**: 敵がゆっくりと剣士に向かって移動することを確認

**手順**
1. `/` にアクセス
2. 敵が出現するまで待機
3. 敵の初期位置を記録
4. 2秒間待機
5. 敵の位置が中央に向かって移動していることを確認

---

### TC05: 攻撃機能の確認

**目的**: 「斬る」ボタンで攻撃できることを確認

**手順**
1. `/` にアクセス
2. `slash-button` をクリック
3. 剣士キャラクターに攻撃アニメーション（点滅など）が発生することを確認
4. `attack-range` が一時的に表示されることを確認

---

### TC06: 敵を倒す機能の確認

**目的**: 攻撃範囲内の敵を倒せることを確認

**手順**
1. `/` にアクセス
2. 敵が剣士の近くに来るまで待機
3. 敵が攻撃範囲内にいる時に `slash-button` をクリック
4. 敵が消失することを確認
5. スコアが10点増加することを確認

---

### TC07: スコア計算の確認

**目的**: 敵を倒した時のスコア加算が正確であることを確認

**手順**
1. `/` にアクセス
2. 初期スコア（0点）を確認
3. 敵を1体倒す
4. スコアが10点になることを確認
5. さらに敵を1体倒す
6. スコアが20点になることを確認

---

### TC08: 体力減少の確認

**目的**: 敵が剣士に到達した時に体力が減ることを確認

**手順**
1. `/` にアクセス
2. 初期体力（3）を確認
3. 敵が出現しても攻撃せずに放置
4. 敵が剣士に到達することを確認
5. 体力が1減少（2になる）することを確認

---

### TC09: ゲームオーバーの確認

**目的**: 体力がゼロになった時にゲームオーバーになることを確認

**手順**
1. `/` にアクセス
2. 敵を3回到達させて体力を0にする
3. ゲームが停止することを確認
4. `restart-button` が表示されることを確認
5. タイマーが停止することを確認

---

### TC10: 時間切れの確認

**目的**: 制限時間が経過した時にゲームが終了することを確認

**手順**
1. `/` にアクセス  
2. ゲームを60秒間プレイ（または時間を早送り）
3. タイマーが0になった時にゲームが終了することを確認
4. 最終スコアが表示されることを確認
5. `restart-button` が表示されることを確認

---

### TC11: ゲーム再開機能の確認

**目的**: ゲーム終了後に再開できることを確認

**手順**
1. ゲームを終了状態にする（体力0または時間切れ）
2. `restart-button` をクリック
3. ゲーム状態が初期状態にリセットされることを確認
   - スコア: 0
   - 体力: 3  
   - タイマー: 60
   - 敵が全て消去される

---

### TC12: 攻撃範囲外での攻撃確認

**目的**: 攻撃範囲外の敵は倒せないことを確認

**手順**
1. `/` にアクセス
2. 敵が攻撃範囲外（画面端など）にいる時に `slash-button` をクリック
3. 敵が倒されないことを確認
4. スコアが変化しないことを確認

---

### TC13: 多重クリック防止

**目的**: 「斬る」ボタンの連打で状態が不正にならないことを確認

**手順**
1. `/` にアクセス
2. `slash-button` を短時間で複数回連続クリック
3. 攻撃アニメーションが正常に動作することを確認
4. スコアやゲーム状態に異常がないことを確認

---

### TC14: モバイル対応確認

**目的**: モバイル画面サイズでレイアウトが破綻していないことを確認

**手順**
1. ビューポートを iPhone SE サイズ (375x667) に設定
2. `/` にアクセス
3. 主要UI (`slash-button`, `game-field`, `score`) が表示され、画面内に収まっていることを確認
4. ゲームが正常にプレイできることを確認

---

## 🔧 テストのための補足実装（推奨）

- 敵キャラクターに一意のIDやclass属性を付与して識別しやすくすること
- 攻撃範囲の当たり判定をテスト可能にするためのdata属性を付与
- テスト中のみ時間の流れを制御するオプション（例: ?test=true）を用意すると、精度の高い検証が可能

---

## 📄 備考

- ゲームの非同期・アニメーション要素が多いため、適切な待機時間の設定に注意
- 敵の出現タイミングがランダムなため、`page.waitForSelector` を活用
- タイミングに依存するテストでは `expect.poll` の使用を推奨